; TCG Card Shop Simulator
; カードボックスを開封するためのAutoHotkeyスクリプト
;
; ＊使い方
; - 1. ゲームを起動し、事前にカードボックスを棚に陳列します
; - 2. 本スクリプトを起動します
; - 3. 自動処理開始のメッセージが表示されるので、ゲーム画面をアクティブにします
; - 3-1. ゲーム内の視点をカードボックスに合わせておきます
; - 4. 自動的にカードボックスが開封されます（1ボックス=約45秒）
; - NOTE. スタッフの補充するタイミングとうまく噛み合えば、繰り返し開封できます（推奨時刻：AM 8:00）
; ＊終了方法
; - ESC キーを押す

Esc:: {
    MsgBox "自動処理を停止します"
    ExitApp
}

MsgBox "自動処理を開始します（5秒後）"
Sleep(5000)

Loop {
    ; 右クリック：アイテムを取る（0.5秒）
    Click("right", "down")
    Sleep(500)
    Click("right", "up")

    ; Rキー：カードボックスを開ける（3秒）
    Send("r")
    Sleep(3000)
    
    ; Rキー：オープンパック
    Send("r")

    ; 開封する（40秒）
    Loop 40 {
        ; 左クリック（1秒間隔）
        Click("left", "down")
        Sleep(1000)
    }

    Click("left", "up")
}
